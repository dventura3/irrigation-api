@prefix ex: <http://example.org/>.
@prefix http: <http://www.w3.org/2011/http#>.
@prefix st: <http://www.mystates.org/states#>.
@prefix log: <http://www.w3.org/2000/10/swap/log#>.
@prefix bonsai: <http://lpis.csd.auth.gr/ontologies/bonsai/BOnSAI.owl#>.


{
  ?pump a ex:IrrigationPump.
	?state a st:State;
			log:includes { ?pump ex:isSwitched ?oldValue. }.

	?newSwitching a bonsai:SwitchAction;
			ex:hasValue ?newValue.
}
=>
{
	_:request http:methodName "PUT";
            http:requestURI ("actuators/" ?pump "/" ?newValue).

  [ a st:StateTransition;
  	st:typeOperation "replacement";
    st:oldComponent { ?pump ex:isSwitched ?oldValue. };
    st:newComponent { ?pump ex:isSwitched ?newSwitching. };
    st:originalState ?state
  ].
}.